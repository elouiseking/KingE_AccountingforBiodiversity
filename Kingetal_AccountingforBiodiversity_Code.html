<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="KingE">

<title>Kingetal_AccountingforBiodiversity_Code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Kingetal_AccountingforBiodiversity_Code_files/libs/clipboard/clipboard.min.js"></script>
<script src="Kingetal_AccountingforBiodiversity_Code_files/libs/quarto-html/quarto.js"></script>
<script src="Kingetal_AccountingforBiodiversity_Code_files/libs/quarto-html/popper.min.js"></script>
<script src="Kingetal_AccountingforBiodiversity_Code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Kingetal_AccountingforBiodiversity_Code_files/libs/quarto-html/anchor.min.js"></script>
<link href="Kingetal_AccountingforBiodiversity_Code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Kingetal_AccountingforBiodiversity_Code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Kingetal_AccountingforBiodiversity_Code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Kingetal_AccountingforBiodiversity_Code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Kingetal_AccountingforBiodiversity_Code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Kingetal_AccountingforBiodiversity_Code</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>KingE </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="ecosystem-accounting-for-biodiversity-on-windfarms." class="level2">
<h2 class="anchored" data-anchor-id="ecosystem-accounting-for-biodiversity-on-windfarms.">Ecosystem accounting for biodiversity on windfarms.</h2>
<p>Source code for plots and models run for King et al.&nbsp;Ecosystem accounting for biodiversity on windfarms. All windfarm sites have been annonymised and spatial co-ordinates removed.</p>
</section>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|echo: false</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'cowplot' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpattern)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'nlme' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix) <span class="co">#source package for lme4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Matrix' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lme4'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:nlme':

    lmList</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'wec' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'DHARMa' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'car' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'carData' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="indicator-selection" class="level2">
<h2 class="anchored" data-anchor-id="indicator-selection">Indicator selection</h2>
<p><strong><em>Fig. 3.</em></strong> Distribution of indicators across the SEEA-EA’s Ecosystem Condition Typology characteristics (a) and across the Fossitt (2000) habtiat types (b) identified on Irish windfarm sites.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|echo: false</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#colour selection</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>dark2 <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>accent <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Accent"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>paired <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">12</span>, <span class="st">"Paired"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>set2 <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Set2"</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>reylgn <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">"RdYlGn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in data:</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>indicators <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"ConditionIndicators_Habitats.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#check structure</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(indicators)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   134 obs. of  7 variables:
 $ ECT_Class     : chr  "Abiotic" "Abiotic" "Abiotic" "Abiotic" ...
 $ Characteristic: chr  "Physical State" "Physical State" "Physical State" "Physical State" ...
 $ Variable      : chr  "Bare ground (soil or peat)" "Bare ground (soil or peat)" "Bare ground (soil or peat)" "Bare ground (soil or peat)" ...
 $ Measurement   : chr  "Index (0-3)" "Index (0-3)" "Index (0-3)" "Index (0-3)" ...
 $ Habitat       : chr  "BC1" "ED2" "ED3" "FS1" ...
 $ Dataset_Age   : int  2022 2022 2022 2022 2022 2022 2022 2022 2022 2022 ...
 $ Data_Type     : chr  "Both" "Both" "Both" "Both" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#change to factors</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>indicators<span class="sc">$</span>ECT_Class <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(indicators<span class="sc">$</span>ECT_Class)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>indicators<span class="sc">$</span>Characteristic <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(indicators<span class="sc">$</span>Characteristic)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>indicators<span class="sc">$</span>Habitat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(indicators<span class="sc">$</span>Habitat)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>indicators<span class="sc">$</span>Dataset_Age <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(indicators<span class="sc">$</span>Dataset_Age)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate data by characteristic</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>characteristic_counts <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Variable <span class="sc">~</span> Characteristic, <span class="at">data =</span> indicators, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>ect_type <span class="ot">&lt;-</span> indicators<span class="sc">$</span>ECT_Class[<span class="fu">match</span>(characteristic_counts<span class="sc">$</span>Characteristic, indicators<span class="sc">$</span>Characteristic)]</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>characteristic_counts<span class="sc">$</span>ECT_Class <span class="ot">&lt;-</span> ect_type</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="fig.-3a" class="level5">
<h5 class="anchored" data-anchor-id="fig.-3a">Fig. 3(a) :</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#labels for the xaxis</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>ect_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Chemical State"</span>, <span class="st">"Physical State"</span>, <span class="st">"Compositional State"</span>, <span class="st">"Structural State"</span>, <span class="st">"Landscape"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the characteristic counts</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>characteristic_bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(characteristic_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">interaction</span>(Characteristic, ECT_Class), <span class="at">y =</span> Variable, <span class="at">fill =</span> Characteristic, <span class="at">pattern =</span> ECT_Class)) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar_pattern</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">pattern_density =</span> <span class="fl">0.05</span>,         <span class="co"># Adjust density of the pattern</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">pattern_spacing =</span> <span class="fl">0.05</span>,        <span class="co"># Adjust spacing between pattern lines</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">pattern_angle =</span> <span class="dv">45</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.legend =</span> <span class="fu">c</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">pattern =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span>          <span class="co"># Adjust the angle of the hatching) +</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> accent) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_pattern_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"stripe"</span>, <span class="st">"crosshatch"</span>, <span class="st">"none"</span>)) <span class="sc">+</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Characteristic"</span>, <span class="at">y =</span> <span class="st">"No. of Indicators"</span>, <span class="at">pattern =</span> <span class="st">"ECT Class"</span>) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> ect_labels) <span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(characteristic_counts<span class="sc">$</span>Variable), <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">pattern =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span><span class="st">"black"</span>),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(a)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fig.-3b" class="level5">
<h5 class="anchored" data-anchor-id="fig.-3b">Fig. 3(b):</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of characteristics per habitat type</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>habitat_counts <span class="ot">&lt;-</span> indicators <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Habitat, Characteristic) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Habitat'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the characteristics per habitat type</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>habitat_bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(habitat_counts, <span class="fu">aes</span>(<span class="at">x =</span> Habitat, <span class="at">y =</span> count, <span class="at">fill =</span> Characteristic)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> accent) <span class="sc">+</span>             <span class="co"># Keep the same color scheme) +</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Habitat"</span>, <span class="at">y =</span> <span class="st">"No. of Indicators"</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(characteristic_counts<span class="sc">$</span>Variable), <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">color =</span><span class="st">"black"</span>),</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(b)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#combine the bar plots</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>indicator_bars <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(characteristic_bar, habitat_bar, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">align =</span> <span class="st">"v"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#save</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("indicator_bars.png", plot = indicator_bars, dpi = 1000, height = 10, width = 20)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="extent-accounts" class="level2">
<h2 class="anchored" data-anchor-id="extent-accounts">Extent accounts</h2>
<p>Results section - number of habitats identified using Fossitt (2000) Guide to Habitat’s in Ireland and the IUCN Global Ecosystem Typology.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in the data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>extent_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"extent_data_anon.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check structure</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(extent_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   666 obs. of  11 variables:
 $ AssetID           : chr  "BAWS504" "BAWS502" "BAWD401" "BAWD402" ...
 $ Site              : chr  "A" "A" "A" "A" ...
 $ County            : chr  "Cork" "Cork" "Cork" "Cork" ...
 $ Land_use          : chr  "Commercial forestry" "Commercial forestry" "Commercial forestry" "Commercial forestry" ...
 $ IUCN_habitat_realm: chr  "Terrestrial" "Terrestrial" "Terrestrial" "Terrestrial" ...
 $ IUCN_habitat_biome: chr  "T3" "T3" "T7" "T7" ...
 $ IUCN_habitat_EFG  : chr  "T3.3" "T3.3" "T7.3" "T7.3" ...
 $ Fossitt           : chr  "WS5" "WS5" "WD4" "WD4" ...
 $ Area_m2           : int  197822 94268 86065 5849 63910 52533 47913 62600 70643 77331 ...
 $ Area_ha           : int  20 10 9 1 6 5 5 6 7 8 ...
 $ Percent_Cover_m2  : num  4.504 2.146 1.96 0.133 1.455 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set as factors</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(extent_data<span class="sc">$</span>Site)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>County <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(extent_data<span class="sc">$</span>County)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>Fossitt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(extent_data<span class="sc">$</span>Fossitt)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>Land_use <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(extent_data<span class="sc">$</span>Land_use)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>IUCN_habitat_biome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(extent_data<span class="sc">$</span>IUCN_habitat_biome)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>IUCN_habitat_realm <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(extent_data<span class="sc">$</span>IUCN_habitat_realm)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>IUCN_habitat_EFG <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(extent_data<span class="sc">$</span>IUCN_habitat_EFG)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>extent_data<span class="sc">$</span>Percent_Cover_m2 <span class="ot">&lt;-</span> <span class="fu">round</span>(extent_data<span class="sc">$</span>Percent_Cover_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of habitats (Fossitt)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(extent_data<span class="sc">$</span>Fossitt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] WS5     WD4     HH1     GS2     ED3/HH1 ED3     ED2     BL3     WS1    
[10] GS4     LR4     GS1     FS1     BC1     HD1     GA1     PB4HH3  PB4    
[19] PB2     FL2     FL1     ER1     PB5     FW4     FW2     HH3     GS3    
27 Levels: BC1 BL3 ED2 ED3 ED3/HH1 ER1 FL1 FL2 FS1 FW2 FW4 GA1 GS1 GS2 ... WS5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(extent_data<span class="sc">$</span>Fossitt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of habitats (general)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(extent_data<span class="sc">$</span>IUCN_habitat_EFG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] T3.3  T7.3  T7.5  T7.4  MT1.3 TF1.3 T7.1  T7.2  TF1.6 F2.2  F3.5  F1.2 
Levels: F1.2 F2.2 F3.5 MT1.3 T3.3 T7.1 T7.2 T7.3 T7.4 T7.5 TF1.3 TF1.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(extent_data<span class="sc">$</span>IUCN_habitat_EFG))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#frequency of habitats</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>habitat_counts <span class="ot">&lt;-</span> extent_data <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Fossitt) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(habitat_counts, <span class="at">n =</span> <span class="dv">27</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 2
   Fossitt count
   &lt;fct&gt;   &lt;int&gt;
 1 BC1         3
 2 BL3        10
 3 ED2        61
 4 ED3        47
 5 ED3/HH1    11
 6 ER1         1
 7 FL1        12
 8 FL2         1
 9 FS1         1
10 FW2         2
11 FW4         1
12 GA1       163
13 GS1         8
14 GS2        46
15 GS3         1
16 GS4         9
17 HD1         4
18 HH1         1
19 HH3         2
20 LR4         1
21 PB2        24
22 PB4        13
23 PB4HH3     90
24 PB5         6
25 WD4       118
26 WS1        18
27 WS5        12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>iucn_counts <span class="ot">&lt;-</span> extent_data <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(IUCN_habitat_EFG) <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iucn_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   IUCN_habitat_EFG count
   &lt;fct&gt;            &lt;int&gt;
 1 F1.2                 2
 2 F2.2                13
 3 F3.5                 1
 4 MT1.3                1
 5 T3.3                37
 6 T7.1                 3
 7 T7.2               163
 8 T7.3               118
 9 T7.4               130
10 T7.5                64
11 TF1.3                1
12 TF1.6              133</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the frequency of habitats</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(habitat_counts, <span class="fu">aes</span>(<span class="at">x =</span> Fossitt, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#386CB0"</span>) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fossitt Code (Level 3)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_continuous(breaks = seq(0, max(habitat_counts$count), by = 2)) +</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(a)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate the Fossitt Codes for each Land Use type </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>total_areas_fossitt <span class="ot">&lt;-</span> extent_data <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Land_use, Fossitt) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_area_m2 =</span> <span class="fu">sum</span>(Area_m2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Land_use'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(total_areas_fossitt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37 × 3
   Land_use    Fossitt total_area_m2
   &lt;fct&gt;       &lt;fct&gt;           &lt;int&gt;
 1 Agriculture BC1             55713
 2 Agriculture BL3              5685
 3 Agriculture ED2            130110
 4 Agriculture ED3             57975
 5 Agriculture FS1              9547
 6 Agriculture FW2             15079
 7 Agriculture FW4              3333
 8 Agriculture GA1           2531093
 9 Agriculture GS1             92432
10 Agriculture GS2             63585
# ℹ 27 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate the IUCN EFG for each Land Use type</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>total_areas_IUCN <span class="ot">&lt;-</span> extent_data <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Land_use, IUCN_habitat_EFG) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_area_m2 =</span> <span class="fu">sum</span>(Area_m2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Land_use'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(total_areas_IUCN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 3
   Land_use                     IUCN_habitat_EFG total_area_m2
   &lt;fct&gt;                        &lt;fct&gt;                    &lt;int&gt;
 1 Agriculture                  F1.2                     15079
 2 Agriculture                  F3.5                      3333
 3 Agriculture                  MT1.3                     5965
 4 Agriculture                  T3.3                    123956
 5 Agriculture                  T7.1                     55713
 6 Agriculture                  T7.2                   2531093
 7 Agriculture                  T7.3                    281703
 8 Agriculture                  T7.4                    193770
 9 Agriculture                  T7.5                    216647
10 Agriculture                  TF1.3                     9547
11 Commercial forestry          F2.2                    414837
12 Commercial forestry          T3.3                   2008530
13 Commercial forestry          T7.3                  21275055
14 Commercial forestry          T7.4                    879913
15 Commercial forestry          T7.5                     63192
16 Commercial forestry          TF1.6                  1615128
17 Upland blanket bog and heath T7.4                     86050
18 Upland blanket bog and heath TF1.6                  1898349</code></pre>
</div>
</div>
</section>
<section id="condition-accounts" class="level2">
<h2 class="anchored" data-anchor-id="condition-accounts">Condition accounts</h2>
<p>Results section - differences among habitats.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in the data</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>condition_scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"condition_data_anon.csv"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check the structure</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(condition_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3948 obs. of  19 variables:
 $ AssetID            : chr  "BAED302" "BAED303" "BAED304" "BAED306" ...
 $ Site               : chr  "A" "A" "A" "A" ...
 $ Land_use           : chr  "Commercial forestry" "Commercial forestry" "Commercial forestry" "Commercial forestry" ...
 $ IUCN_habitat_realm : chr  "Terrestrial" "Terrestrial" "Terrestrial" "Terrestrial" ...
 $ IUCN_habitat_biome : chr  "T7" "T7" "T7" "T7" ...
 $ IUCN_habitat_EFG   : chr  "T7.4" "T7.4" "T7.4" "T7.4" ...
 $ IUCN_habitat       : chr  "Urban and industrial ecosystems" "Urban and industrial ecosystems" "Urban and industrial ecosystems" "Urban and industrial ecosystems" ...
 $ FossittLvl1        : chr  "E" "E" "E" "E" ...
 $ FossittLvl2        : chr  "ED" "ED" "ED" "ED" ...
 $ Fossitt            : chr  "ED3" "ED3" "ED3" "ED3" ...
 $ Area_m2            : int  2377 3526 692 1779 1025 2377 3526 692 1779 1025 ...
 $ Characteristic.Type: chr  "Abiotic characteristics" "Abiotic characteristics" "Abiotic characteristics" "Abiotic characteristics" ...
 $ Class              : chr  "Physical state" "Physical state" "Physical state" "Physical state" ...
 $ Variable           : chr  "Bare ground" "Bare ground" "Bare ground" "Bare ground" ...
 $ Measurement_unit   : chr  "Index (0-3)" "Index (0-3)" "Index (0-3)" "Index (0-3)" ...
 $ Opening_Value      : chr  "0" "0" "0" "0" ...
 $ Standardised_Value : num  0 0 0 0 0 1 1 1 1 1 ...
 $ Referenced_value   : num  0 0 0 0 0 1 1 1 1 1 ...
 $ Weighted           : num  0 0 0 0 0 0.25 0.25 0.25 0.25 0.25 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set as factors</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>AssetID <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>AssetID)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>Site)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>Land_use <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>Land_use)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>IUCN_habitat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>IUCN_habitat)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>IUCN_habitat_EFG <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>IUCN_habitat_EFG)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>FossittLvl1 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>FossittLvl1)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>FossittLvl2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>FossittLvl2)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>condition_scores<span class="sc">$</span>Fossitt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(condition_scores<span class="sc">$</span>Fossitt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> condition_scores <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(AssetID) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">condscore =</span> <span class="fu">sum</span>(Weighted))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 593 × 2
   AssetID    condscore
   &lt;fct&gt;          &lt;dbl&gt;
 1 BAED302        0.333
 2 BAED303        0.417
 3 BAED304        0.5  
 4 BAED306        0.417
 5 BAED307        0.417
 6 BAED3HH102     0.583
 7 BAED3HH103     0.583
 8 BAED3HH104     0.472
 9 BAED3HH108     0.528
10 BAED3HH112     0.500
# ℹ 583 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(scores<span class="sc">$</span>condscore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(scores<span class="sc">$</span>condscore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8888889</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(scores<span class="sc">$</span>condscore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4673396</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fixing errors where condition score is &gt;1</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#errors &lt;- scores[scores$condscore &gt;1, ]</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">#errors</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co">#giving land use a name for labellilng</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>landuse <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Commercial forestry"</span>, <span class="st">"Upland blanket bog"</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">#giving sites a name for labelling</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>sites_anon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co">#add existing informational data to the condition scores</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>unique_assets <span class="ot">&lt;-</span> condition_scores <span class="sc">%&gt;%</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(AssetID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AssetID, Site, Land_use, IUCN_habitat, IUCN_habitat_EFG, Fossitt, FossittLvl1, FossittLvl2, Area_m2)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>condscores <span class="ot">&lt;-</span> <span class="fu">left_join</span>(scores, unique_assets, <span class="at">by =</span> <span class="st">"AssetID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#working out average condition scores across groupings</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Land Use:</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(condscore <span class="sc">~</span> Land_use, <span class="at">data =</span> condscores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Land_use condscore
1                  Agriculture 0.3948247
2          Commercial forestry 0.5426251
3 Upland blanket bog and heath 0.4261905</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#IUCN habitat class</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(condscore <span class="sc">~</span> IUCN_habitat, <span class="at">data =</span> condscores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  IUCN_habitat condscore
1                             Annual croplands 0.6250000
2      Boreal, temperate and montane peat bogs 0.6152882
3                    Cool temperate heathlands 0.3664066
4  Derived semi-natural pastures and oldfields 0.3638672
5                     Permanent lowland rivers 0.2000000
6                            Permanent marshes 0.8888889
7                                  Plantations 0.4773504
8                             Sandy shorelines 0.5000000
9             Small permanent freshwater lakes 0.5717949
10                    Sown pastures and fields 0.4265082
11             Urban and industrial ecosystems 0.3478927</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#IUCN habitat EFG</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(condscore <span class="sc">~</span> IUCN_habitat_EFG, <span class="at">data =</span> condscores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   IUCN_habitat_EFG condscore
1              F1.2 0.2000000
2              F2.2 0.5717949
3             MT1.3 0.5000000
4              T3.3 0.3664066
5              T7.1 0.6250000
6              T7.2 0.4265082
7              T7.3 0.4773504
8              T7.4 0.3478927
9              T7.5 0.3638672
10            TF1.3 0.8888889
11            TF1.6 0.6152882</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fossitt Lvl 3</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(condscore <span class="sc">~</span> Fossitt, <span class="at">data =</span> condscores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Fossitt condscore
1      BC1 0.6250000
2      ED3 0.3046099
3   ED3HH1 0.5328283
4      FL1 0.6000000
5      FL2 0.2333333
6      FS1 0.8888889
7      FW2 0.2000000
8      GA1 0.4265082
9      GS1 0.3722222
10     GS2 0.3464976
11     GS3 0.3666667
12     GS4 0.4449074
13     HD1 0.3611111
14     HH1 0.4814815
15     HH3 0.5000000
16     LR4 0.5000000
17     PB2 0.5041667
18     PB4 0.6666667
19  PB4HH3 0.6540741
20     PB5 0.3666667
21     WD4 0.4710452
22     WS1 0.3463467
23     WS5 0.5393519</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fossitt Lvl 1</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(condscore <span class="sc">~</span> FossittLvl1, <span class="at">data =</span> condscores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  FossittLvl1 condscore
1           B 0.6250000
2           E 0.3478927
3           F 0.5451389
4           G 0.4088473
5           H 0.4179894
6           L 0.5000000
7           P 0.6152882
8           W 0.4614175</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fossitt Lvl 2</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(condscore <span class="sc">~</span> FossittLvl2, <span class="at">data =</span> condscores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   FossittLvl2 condscore
1           BC 0.6250000
2           ED 0.3478927
3           FL 0.5717949
4           FS 0.8888889
5           FW 0.2000000
6           GA 0.4265082
7           GS 0.3638672
8           HD 0.3611111
9           HH 0.4938272
10          LR 0.5000000
11          PB 0.6152882
12          WD 0.4710452
13          WS 0.4235487</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#site:</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(condscore <span class="sc">~</span> Site,  <span class="at">data =</span> condscores, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Site condscore
1    A 0.4804266
2    B 0.4699832
3    C 0.5664779
4    D 0.4261905
5    E 0.3572072
6    F 0.2604045
7    G 0.3850575</code></pre>
</div>
</div>
<p>Boxplots of distribution of condition score for each category:</p>
<section id="fig.-4a" class="level5">
<h5 class="anchored" data-anchor-id="fig.-4a">Fig. 4(a)</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Land use:</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>landuse_bp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(condscores, <span class="fu">aes</span>(<span class="at">x =</span> Land_use, <span class="at">y =</span> condscore, <span class="at">fill =</span> Land_use)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> landuse) <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> accent) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Land use"</span>, <span class="at">y =</span> <span class="st">"Condition Score"</span>, <span class="at">fill =</span> <span class="st">"Land Use"</span>) <span class="sc">+</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(a) Land use"</span>) <span class="sc">+</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fig.-4b" class="level5">
<h5 class="anchored" data-anchor-id="fig.-4b">Fig. 4(b)</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>iucn_bp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(condscores, <span class="fu">aes</span>(<span class="at">x =</span> IUCN_habitat_EFG, <span class="at">y =</span> condscore)) <span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"IUCN Habitat Class"</span>, <span class="at">y =</span> <span class="st">"Condition Score"</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(b) IUCN Habitat Class"</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fig.-4c" class="level5">
<h5 class="anchored" data-anchor-id="fig.-4c">Fig. 4(c)</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>fossittlvl2_bp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(condscores, <span class="fu">aes</span>(<span class="at">x =</span> FossittLvl2, <span class="at">y =</span> condscore)) <span class="sc">+</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fossitt (Lvl 2)"</span>, <span class="at">y =</span> <span class="st">"Condition Score"</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(c) Fossitt (Lvl2)"</span>) <span class="sc">+</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fig.-4d" class="level5">
<h5 class="anchored" data-anchor-id="fig.-4d">Fig. 4(d)</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>site_bp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(condscores, <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">y =</span> condscore, <span class="at">fill =</span> Land_use)) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> sites_anon) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> accent,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> landuse) <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Site"</span>, <span class="at">y =</span> <span class="st">"Condition Score"</span>, <span class="at">fill =</span> <span class="st">"Land use"</span>) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(d) Site"</span>) <span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),   </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(legend.position = "none")</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a> <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fig.4-all" class="level5">
<h5 class="anchored" data-anchor-id="fig.4-all">Fig.4 (all)</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#put them together</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>condscore_boxplots <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(landuse_bp, iucn_bp, fossittlvl2_bp, site_bp, <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("condscore_boxplots.png", plot = condscore_boxplots, dpi = 1000, height = 20, width = 24)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelling-how-condition-scores-vary" class="level3">
<h3 class="anchored" data-anchor-id="modelling-how-condition-scores-vary">Modelling how condition scores vary</h3>
<p>Modelling how condition scores vary using mixed-effects model (as site is a random effect), and Weighted Effects Coding.</p>
<section id="m1---model-1" class="level5">
<h5 class="anchored" data-anchor-id="m1---model-1">m1 - model 1</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling how condition scores vary with IUCN habitat type </span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mixed-effects model -&gt; because site is a random effect</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lme</span>(condscore <span class="sc">~</span> IUCN_habitat, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Site, <span class="at">data =</span> condscores)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: condscores 
       AIC       BIC   logLik
  -894.957 -838.1929 460.4785

Random effects:
 Formula: ~1 | Site
        (Intercept)  Residual
StdDev:  0.08865882 0.1049308

Fixed effects:  condscore ~ IUCN_habitat 
                                                             Value  Std.Error
(Intercept)                                              0.5927669 0.06994972
IUCN_habitatBoreal, temperate and montane peat bogs      0.0100043 0.06523618
IUCN_habitatCool temperate heathlands                   -0.3040463 0.06439514
IUCN_habitatDerived semi-natural pastures and oldfields -0.2671191 0.06229283
IUCN_habitatPermanent lowland rivers                    -0.2896431 0.09659360
IUCN_habitatPermanent marshes                            0.1962105 0.12132339
IUCN_habitatPlantations                                 -0.1659789 0.06421823
IUCN_habitatSandy shorelines                            -0.1926784 0.12132339
IUCN_habitatSmall permanent freshwater lakes            -0.0595262 0.07101191
IUCN_habitatSown pastures and fields                    -0.2052301 0.06146665
IUCN_habitatUrban and industrial ecosystems             -0.2316482 0.06278563
                                                         DF   t-value p-value
(Intercept)                                             576  8.474186  0.0000
IUCN_habitatBoreal, temperate and montane peat bogs     576  0.153355  0.8782
IUCN_habitatCool temperate heathlands                   576 -4.721571  0.0000
IUCN_habitatDerived semi-natural pastures and oldfields 576 -4.288120  0.0000
IUCN_habitatPermanent lowland rivers                    576 -2.998575  0.0028
IUCN_habitatPermanent marshes                           576  1.617252  0.1064
IUCN_habitatPlantations                                 576 -2.584607  0.0100
IUCN_habitatSandy shorelines                            576 -1.588139  0.1128
IUCN_habitatSmall permanent freshwater lakes            576 -0.838256  0.4022
IUCN_habitatSown pastures and fields                    576 -3.338885  0.0009
IUCN_habitatUrban and industrial ecosystems             576 -3.689511  0.0002
 Correlation: 
                                                        (Intr) Itampb IUCNth
IUCN_habitatBoreal, temperate and montane peat bogs     -0.847              
IUCN_habitatCool temperate heathlands                   -0.819  0.879       
IUCN_habitatDerived semi-natural pastures and oldfields -0.854  0.924  0.918
IUCN_habitatPermanent lowland rivers                    -0.547  0.591  0.582
IUCN_habitatPermanent marshes                           -0.431  0.460  0.473
IUCN_habitatPlantations                                 -0.854  0.975  0.892
IUCN_habitatSandy shorelines                            -0.431  0.460  0.473
IUCN_habitatSmall permanent freshwater lakes            -0.777  0.902  0.808
IUCN_habitatSown pastures and fields                    -0.859  0.917  0.935
IUCN_habitatUrban and industrial ecosystems             -0.854  0.932  0.908
                                                        IUspao IUCNlr IUCN_m
IUCN_habitatBoreal, temperate and montane peat bogs                         
IUCN_habitatCool temperate heathlands                                       
IUCN_habitatDerived semi-natural pastures and oldfields                     
IUCN_habitatPermanent lowland rivers                     0.613              
IUCN_habitatPermanent marshes                            0.484  0.307       
IUCN_habitatPlantations                                  0.941  0.601  0.468
IUCN_habitatSandy shorelines                             0.484  0.307  0.252
IUCN_habitatSmall permanent freshwater lakes             0.850  0.543  0.423
IUCN_habitatSown pastures and fields                     0.961  0.613  0.494
IUCN_habitatUrban and industrial ecosystems              0.951  0.615  0.478
                                                        IUCN_P IUCN_s IUCpfl
IUCN_habitatBoreal, temperate and montane peat bogs                         
IUCN_habitatCool temperate heathlands                                       
IUCN_habitatDerived semi-natural pastures and oldfields                     
IUCN_habitatPermanent lowland rivers                                        
IUCN_habitatPermanent marshes                                               
IUCN_habitatPlantations                                                     
IUCN_habitatSandy shorelines                             0.468              
IUCN_habitatSmall permanent freshwater lakes             0.898  0.423       
IUCN_habitatSown pastures and fields                     0.931  0.494  0.842
IUCN_habitatUrban and industrial ecosystems              0.945  0.478  0.855
                                                        IUCpaf
IUCN_habitatBoreal, temperate and montane peat bogs           
IUCN_habitatCool temperate heathlands                         
IUCN_habitatDerived semi-natural pastures and oldfields       
IUCN_habitatPermanent lowland rivers                          
IUCN_habitatPermanent marshes                                 
IUCN_habitatPlantations                                       
IUCN_habitatSandy shorelines                                  
IUCN_habitatSmall permanent freshwater lakes                  
IUCN_habitatSown pastures and fields                          
IUCN_habitatUrban and industrial ecosystems              0.953

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-3.22556874 -0.69547238 -0.06679483  0.63291662  5.22543637 

Number of Observations: 593
Number of Groups: 7 </code></pre>
</div>
</div>
</section>
<section id="m2---model-2" class="level5">
<h5 class="anchored" data-anchor-id="m2---model-2">m2 - model 2</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling how condition scores vary with Fossitt (Lvl3) habitat type</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mixed-effects model -&gt; because site is a random effect</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lme</span>(condscore <span class="sc">~</span> Fossitt, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Site, <span class="at">data =</span> condscores)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: condscores 
       AIC       BIC   logLik
  -899.269 -790.6281 474.6345

Random effects:
 Formula: ~1 | Site
        (Intercept)   Residual
StdDev:  0.06521941 0.09941512

Fixed effects:  condscore ~ Fossitt 
                   Value  Std.Error  DF   t-value p-value
(Intercept)    0.5910398 0.06322819 564  9.347726  0.0000
FossittED3    -0.2583559 0.05970714 564 -4.327052  0.0000
FossittED3HH1 -0.1127799 0.06794273 564 -1.659925  0.0975
FossittFL1     0.0193854 0.06830810 564  0.283794  0.7767
FossittFL2    -0.3472812 0.11715694 564 -2.964239  0.0032
FossittFS1     0.1988278 0.11494737 564  1.729729  0.0842
FossittFW2    -0.2948779 0.09152290 564 -3.221902  0.0013
FossittGA1    -0.2007554 0.05824866 564 -3.446523  0.0006
FossittGS1    -0.2220274 0.06776002 564 -3.276673  0.0011
FossittGS2    -0.2752515 0.05981948 564 -4.601369  0.0000
FossittGS3    -0.2293631 0.11586349 564 -1.979598  0.0482
FossittGS4    -0.1816750 0.06666962 564 -2.725004  0.0066
FossittHD1    -0.3015883 0.07622131 564 -3.956746  0.0001
FossittHH1    -0.1641267 0.11662373 564 -1.407318  0.1599
FossittHH3    -0.0960298 0.09210139 564 -1.042653  0.2976
FossittLR4    -0.1900611 0.11494737 564 -1.653462  0.0988
FossittPB2    -0.0646023 0.06568333 564 -0.983541  0.3258
FossittPB4     0.0860521 0.06784277 564  1.268405  0.2052
FossittPB4HH3  0.0734595 0.06286651 564  1.168500  0.2431
FossittPB5    -0.1961794 0.07672809 564 -2.556814  0.0108
FossittWD4    -0.1290698 0.06147035 564 -2.099708  0.0362
FossittWS1    -0.3228186 0.06229027 564 -5.182488  0.0000
FossittWS5    -0.0520950 0.06785132 564 -0.767781  0.4429
 Correlation: 
              (Intr) FssED3 FED3HH FssFL1 FssFL2 FssFS1 FssFW2 FssGA1 FssGS1
FossittED3    -0.890                                                        
FossittED3HH1 -0.801  0.834                                                 
FossittFL1    -0.804  0.831  0.782                                          
FossittFL2    -0.469  0.485  0.456  0.480                                   
FossittFS1    -0.451  0.476  0.419  0.416  0.243                            
FossittFW2    -0.574  0.614  0.537  0.535  0.312  0.306                     
FossittGA1    -0.900  0.949  0.832  0.828  0.483  0.494  0.613              
FossittGS1    -0.776  0.820  0.718  0.715  0.417  0.422  0.533  0.843       
FossittGS2    -0.887  0.934  0.852  0.840  0.490  0.477  0.607  0.945  0.814
FossittGS3    -0.457  0.481  0.420  0.418  0.244  0.248  0.309  0.499  0.435
FossittGS4    -0.786  0.830  0.727  0.724  0.422  0.431  0.536  0.858  0.741
FossittHD1    -0.691  0.724  0.649  0.655  0.382  0.378  0.467  0.744  0.638
FossittHH1    -0.466  0.486  0.469  0.456  0.266  0.244  0.313  0.485  0.418
FossittHH3    -0.575  0.605  0.529  0.526  0.307  0.312  0.389  0.628  0.547
FossittLR4    -0.451  0.476  0.419  0.416  0.243  0.252  0.306  0.494  0.422
FossittPB2    -0.842  0.876  0.793  0.817  0.477  0.433  0.556  0.862  0.744
FossittPB4    -0.809  0.837  0.788  0.829  0.483  0.419  0.539  0.834  0.720
FossittPB4HH3 -0.873  0.903  0.850  0.895  0.522  0.452  0.581  0.900  0.777
FossittPB5    -0.724  0.756  0.670  0.683  0.398  0.371  0.476  0.739  0.638
FossittWD4    -0.888  0.923  0.874  0.892  0.520  0.462  0.595  0.920  0.794
FossittWS1    -0.837  0.882  0.775  0.770  0.449  0.464  0.568  0.916  0.786
FossittWS5    -0.808  0.836  0.791  0.821  0.479  0.419  0.539  0.834  0.720
              FssGS2 FssGS3 FssGS4 FssHD1 FssHH1 FssHH3 FssLR4 FssPB2 FssPB4
FossittED3                                                                  
FossittED3HH1                                                               
FossittFL1                                                                  
FossittFL2                                                                  
FossittFS1                                                                  
FossittFW2                                                                  
FossittGA1                                                                  
FossittGS1                                                                  
FossittGS2                                                                  
FossittGS3     0.476                                                        
FossittGS4     0.826  0.441                                                 
FossittHD1     0.727  0.374  0.650                                          
FossittHH1     0.497  0.245  0.424  0.378                                   
FossittHH3     0.599  0.332  0.555  0.471  0.308                            
FossittLR4     0.477  0.248  0.431  0.378  0.244  0.312                     
FossittPB2     0.864  0.436  0.753  0.673  0.462  0.549  0.433              
FossittPB4     0.845  0.421  0.729  0.660  0.459  0.530  0.419  0.823       
FossittPB4HH3  0.912  0.454  0.786  0.712  0.495  0.572  0.452  0.888  0.901
FossittPB5     0.735  0.374  0.645  0.572  0.390  0.470  0.371  0.798  0.688
FossittWD4     0.935  0.464  0.804  0.723  0.509  0.584  0.462  0.893  0.898
FossittWS1     0.881  0.465  0.801  0.698  0.451  0.585  0.464  0.802  0.776
FossittWS5     0.847  0.421  0.729  0.658  0.461  0.530  0.419  0.818  0.827
              FPB4HH FssPB5 FssWD4 FssWS1
FossittED3                               
FossittED3HH1                            
FossittFL1                               
FossittFL2                               
FossittFS1                               
FossittFW2                               
FossittGA1                               
FossittGS1                               
FossittGS2                               
FossittGS3                               
FossittGS4                               
FossittHD1                               
FossittHH1                               
FossittHH3                               
FossittLR4                               
FossittPB2                               
FossittPB4                               
FossittPB4HH3                            
FossittPB5     0.742                     
FossittWD4     0.969  0.750              
FossittWS1     0.837  0.687  0.856       
FossittWS5     0.893  0.685  0.894  0.776

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-3.2262771 -0.6529239  0.0000000  0.6408177  4.6032276 

Number of Observations: 593
Number of Groups: 7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="m3---model-3" class="level5">
<h5 class="anchored" data-anchor-id="m3---model-3">m3 - model 3</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#modelling how condition scores vary with land use type</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lme</span>(condscore <span class="sc">~</span> Land_use, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Site, <span class="at">data =</span> condscores)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: condscores 
        AIC      BIC   logLik
  -753.9636 -732.063 381.9818

Random effects:
 Formula: ~1 | Site
        (Intercept)  Residual
StdDev:  0.07983249 0.1236421

Fixed effects:  condscore ~ Land_use 
                                         Value  Std.Error  DF  t-value p-value
(Intercept)                          0.3688074 0.04073603 586 9.053594  0.0000
Land_useCommercial forestry          0.1550392 0.07009061   4 2.211983  0.0914
Land_useUpland blanket bog and heath 0.0573830 0.09262088   4 0.619548  0.5691
 Correlation: 
                                     (Intr) Lnd_Cf
Land_useCommercial forestry          -0.581       
Land_useUpland blanket bog and heath -0.440  0.256

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.69045859 -0.75315858 -0.07917006  0.70714988  4.09287264 

Number of Observations: 593
Number of Groups: 7 </code></pre>
</div>
</div>
</section>
<section id="null-model" class="level5">
<h5 class="anchored" data-anchor-id="null-model">Null model</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Generalised linear mixed models (Following similar steps to McKeon et al. (2023))</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Random effects structure</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Random effects capture the variability within groups that cannot be explained by the fixed effects in  the model</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Null model to determine random effects structure</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(condscore <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Site), <span class="at">data =</span> condscores) <span class="co"># 0 represents no fixed effects in the model</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">#the null model contains only the random intercepts for the grouping variable - Site</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(null_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerMod']
Formula: condscore ~ 0 + (1 | Site)
   Data: condscores

     AIC      BIC   logLik deviance df.resid 
  -745.2   -736.4    374.6   -749.2      591 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6925 -0.7551 -0.0918  0.7277  4.1312 

Random effects:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.18522  0.4304  
 Residual             0.01529  0.1236  
Number of obs: 593, groups:  Site, 7</code></pre>
</div>
</div>
</section>
<section id="m4---model-4" class="level5">
<h5 class="anchored" data-anchor-id="m4---model-4">m4 - model 4</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#going to try a maximal GLMM</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(condscore <span class="sc">~</span> Land_use <span class="sc">+</span> Fossitt <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Site),</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> condscores)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: condscore ~ Land_use + Fossitt + (1 | Site)
   Data: condscores

REML criterion at convergence: -942.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2257 -0.6284  0.0000  0.6607  4.6138 

Random effects:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.005700 0.07550 
 Residual             0.009887 0.09943 
Number of obs: 593, groups:  Site, 7

Fixed effects:
                                     Estimate Std. Error t value
(Intercept)                           0.58672    0.06904   8.499
Land_useCommercial forestry           0.02866    0.06907   0.415
Land_useUpland blanket bog and heath -0.02920    0.09097  -0.321
FossittED3                           -0.25748    0.05976  -4.308
FossittED3HH1                        -0.11535    0.06832  -1.688
FossittFL1                            0.01742    0.06885   0.253
FossittFL2                           -0.34924    0.11749  -2.973
FossittFS1                            0.19829    0.11497   1.725
FossittFW2                           -0.29381    0.09155  -3.209
FossittGA1                           -0.20076    0.05827  -3.445
FossittGS1                           -0.22182    0.06778  -3.273
FossittGS2                           -0.27616    0.05990  -4.611
FossittGS3                           -0.22923    0.11590  -1.978
FossittGS4                           -0.18173    0.06669  -2.725
FossittHD1                           -0.30248    0.07626  -3.967
FossittHH1                           -0.16669    0.11686  -1.426
FossittHH3                           -0.09589    0.09214  -1.041
FossittLR4                           -0.19060    0.11497  -1.658
FossittPB2                           -0.06171    0.06663  -0.926
FossittPB4                            0.08409    0.06839   1.230
FossittPB4HH3                         0.07150    0.06345   1.127
FossittPB5                           -0.19086    0.07801  -2.447
FossittWD4                           -0.13112    0.06195  -2.116
FossittWS1                           -0.32320    0.06231  -5.187
FossittWS5                           -0.05416    0.06836  -0.792</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 25 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the model outputs</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co">#forest plot - displaying the estimated coefficients along with their confidence intervals</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co">#extract fixed effects estimates and standard errors</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>fixed_effects <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m4)))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>fixed_effects<span class="sc">$</span>variables <span class="ot">&lt;-</span> <span class="fu">rownames</span>(fixed_effects)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the (Intercept) row, as it's not needed for the plot</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>fixed_effects <span class="ot">&lt;-</span> fixed_effects[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the forest plot</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fixed_effects, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> variables)) <span class="sc">+</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span>,</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span> Estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span>),</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Estimate"</span>, <span class="at">y =</span> <span class="st">"Variables"</span>) <span class="sc">+</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Forest plot of fixed effects"</span>) <span class="sc">+</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#interpretation -&gt; positive estimates indicate a positive association with the responsevariable, negative estimates indicate a negative association</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Weighted effects coding (WEC)</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using Weighted Effects Coding (WEC) for specifying contrasts in GLMMs</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">#specify contrasts for land_use and fossitt variables</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(condscores<span class="sc">$</span>Land_use) <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually specify contrast matrix for Fossitt variable</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: If you want to compare each level with the first level (BC1)</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>condscores<span class="sc">$</span>Land_use.wec <span class="ot">&lt;-</span> <span class="fu">factor</span>(condscores<span class="sc">$</span>Land_use)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(condscores<span class="sc">$</span>Land_use.wec) <span class="ot">&lt;-</span> <span class="fu">contr.wec</span>(condscores<span class="sc">$</span>Land_use, <span class="st">"Agriculture"</span>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>condscores<span class="sc">$</span>IUCN_habitat.wec <span class="ot">&lt;-</span> <span class="fu">factor</span>(condscores<span class="sc">$</span>IUCN_habitat)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(condscores<span class="sc">$</span>IUCN_habitat.wec) <span class="ot">&lt;-</span> <span class="fu">contr.wec</span>(condscores<span class="sc">$</span>IUCN_habitat, <span class="st">"Urban and industrial ecosystems"</span>)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>condscores<span class="sc">$</span>Fossitt.wec <span class="ot">&lt;-</span> <span class="fu">factor</span>(condscores<span class="sc">$</span>Fossitt)</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(condscores<span class="sc">$</span>Fossitt.wec) <span class="ot">&lt;-</span> <span class="fu">contr.wec</span>(condscores<span class="sc">$</span>Fossitt, <span class="st">"GA1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="m5---model-5" class="level5">
<h5 class="anchored" data-anchor-id="m5---model-5">m5 - model 5</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(condscore <span class="sc">~</span> Fossitt.wec <span class="sc">+</span> Land_use <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Site), <span class="at">data =</span> condscores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: condscore ~ Fossitt.wec + Land_use + (1 | Site)
   Data: condscores

REML criterion at convergence: -946.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2263 -0.6529  0.0000  0.6408  4.6032 

Random effects:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.004254 0.06522 
 Residual             0.009883 0.09942 
Number of obs: 593, groups:  Site, 7

Fixed effects:
                   Estimate Std. Error t value
(Intercept)        0.453889   0.025427  17.850
Fossitt.wecBC1     0.137151   0.058340   2.351
Fossitt.wecED3    -0.121205   0.016236  -7.465
Fossitt.wecED3HH1  0.024371   0.032586   0.748
Fossitt.wecFL1     0.156536   0.031286   5.003
Fossitt.wecFL2    -0.210130   0.100193  -2.097
Fossitt.wecFS1     0.335979   0.100248   3.351
Fossitt.wecFW2    -0.157727   0.071743  -2.198
Fossitt.wecGS1    -0.084877   0.036928  -2.298
Fossitt.wecGS2    -0.138101   0.015647  -8.826
Fossitt.wecGS3    -0.092212   0.100822  -0.915
Fossitt.wecGS4    -0.044524   0.035094  -1.269
Fossitt.wecHD1    -0.164437   0.050154  -3.279
Fossitt.wecHH1    -0.026976   0.100234  -0.269
Fossitt.wecHH3     0.041121   0.072273   0.569
Fossitt.wecLR4    -0.052910   0.100248  -0.528
Fossitt.wecPB2     0.072549   0.026998   2.687
Fossitt.wecPB4     0.223203   0.030256   7.377
Fossitt.wecPB4HH3  0.210610   0.016279  12.938
Fossitt.wecPB5    -0.059029   0.048504  -1.217
Fossitt.wecWD4     0.008081   0.012574   0.643
Fossitt.wecWS1    -0.185668   0.026372  -7.040
Fossitt.wecWS5     0.085056   0.030639   2.776</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 23 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>fit warnings:
fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting m5</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>m5_fixed_effects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m5)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>m5_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m5)))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>m5_plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Effect =</span> <span class="fu">names</span>(m5_fixed_effects),</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Estimate =</span> m5_fixed_effects,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">SE =</span> m5_se)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>m5_plot_data<span class="sc">$</span>LowerCI <span class="ot">&lt;-</span> m5_plot_data<span class="sc">$</span>Estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> m5_plot_data<span class="sc">$</span>SE</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>m5_plot_data<span class="sc">$</span>UpperCI <span class="ot">&lt;-</span> m5_plot_data<span class="sc">$</span>Estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> m5_plot_data<span class="sc">$</span>SE</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m5_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> Effect)) <span class="sc">+</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> LowerCI, <span class="at">xmax =</span> UpperCI), <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Estimate"</span>, <span class="at">y =</span> <span class="st">"Effect"</span>) <span class="sc">+</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="m6---model-6" class="level5">
<h5 class="anchored" data-anchor-id="m6---model-6">m6 - model 6</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>m6 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(condscore <span class="sc">~</span> IUCN_habitat.wec <span class="sc">+</span> Land_use <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Site), <span class="at">data =</span> condscores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: condscore ~ IUCN_habitat.wec + Land_use + (1 | Site)
   Data: condscores

REML criterion at convergence: -916.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2256 -0.6955 -0.0668  0.6329  5.2254 

Random effects:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.00786  0.08866 
 Residual             0.01101  0.10493 
Number of obs: 593, groups:  Site, 7

Fixed effects:
                                                             Estimate
(Intercept)                                                  0.435632
IUCN_habitat.wecAnnual croplands                             0.157135
IUCN_habitat.wecBoreal, temperate and montane peat bogs      0.167139
IUCN_habitat.wecCool temperate heathlands                   -0.146911
IUCN_habitat.wecDerived semi-natural pastures and oldfields -0.109984
IUCN_habitat.wecPermanent lowland rivers                    -0.132508
IUCN_habitat.wecPermanent marshes                            0.353346
IUCN_habitat.wecPlantations                                 -0.008844
IUCN_habitat.wecSandy shorelines                            -0.035543
IUCN_habitat.wecSmall permanent freshwater lakes             0.097609
IUCN_habitat.wecSown pastures and fields                    -0.048095
                                                            Std. Error t value
(Intercept)                                                   0.034002  12.812
IUCN_habitat.wecAnnual croplands                              0.061451   2.557
IUCN_habitat.wecBoreal, temperate and montane peat bogs       0.014485  11.539
IUCN_habitat.wecCool temperate heathlands                     0.023283  -6.310
IUCN_habitat.wecDerived semi-natural pastures and oldfields   0.014423  -7.625
IUCN_habitat.wecPermanent lowland rivers                      0.075636  -1.752
IUCN_habitat.wecPermanent marshes                             0.105726   3.342
IUCN_habitat.wecPlantations                                   0.011927  -0.741
IUCN_habitat.wecSandy shorelines                              0.105726  -0.336
IUCN_habitat.wecSmall permanent freshwater lakes              0.031439   3.105
IUCN_habitat.wecSown pastures and fields                      0.013425  -3.583

Correlation of Fixed Effects:
            (Intr) IUCN_c Itampb IUCNth IUspao IUCNlr IUCN_m IUCN_. IUCN_s
IUCN_hbt.Ac -0.009                                                        
IUCN_.tampb  0.055 -0.151                                                 
IUCN_hb.Cth -0.022  0.060 -0.395                                          
IUCN_.Dspao -0.031  0.059 -0.489  0.129                                   
IUCN_hb.Plr -0.010  0.018 -0.095  0.006  0.046                            
IUCN_hbt.Pm -0.005  0.018 -0.098  0.050  0.035  0.002                     
IUCN_hbtt.P  0.057 -0.140  0.399 -0.375 -0.373 -0.078 -0.094              
IUCN_hbt.Ss -0.005  0.018 -0.098  0.050  0.035  0.002  0.015 -0.094       
IUCN_h.Spfl  0.034 -0.072  0.281 -0.186 -0.231 -0.046 -0.046  0.208 -0.046
IUCN_h.Spaf -0.060  0.108 -0.748  0.314  0.236  0.034  0.082 -0.715  0.082
            IUCpfl
IUCN_hbt.Ac       
IUCN_.tampb       
IUCN_hb.Cth       
IUCN_.Dspao       
IUCN_hb.Plr       
IUCN_hbt.Pm       
IUCN_hbtt.P       
IUCN_hbt.Ss       
IUCN_h.Spfl       
IUCN_h.Spaf -0.355
fit warnings:
fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting m6</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>m6_fixed_effects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m6) </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>m6_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m6)))</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>m6_plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Effect =</span> <span class="fu">names</span>(m6_fixed_effects), </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Estimate =</span> m6_fixed_effects, </span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">SE =</span> m6_se)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>m6_plot_data<span class="sc">$</span>LowerCI <span class="ot">&lt;-</span> m6_plot_data<span class="sc">$</span>Estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> m6_plot_data<span class="sc">$</span>SE</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>m6_plot_data<span class="sc">$</span>UpperCI <span class="ot">&lt;-</span> m6_plot_data<span class="sc">$</span>Estimate <span class="sc">+</span><span class="fl">1.96</span> <span class="sc">*</span>m6_plot_data<span class="sc">$</span>SE</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m6_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> Effect)) <span class="sc">+</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> LowerCI, <span class="at">xmax =</span> UpperCI), <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Estimate"</span>, <span class="at">y =</span> <span class="st">"Effect"</span>) <span class="sc">+</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Setting the reference value to forestry</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>condscores<span class="sc">$</span>Land_use.wec <span class="ot">&lt;-</span> <span class="fu">factor</span>(condscores<span class="sc">$</span>Land_use)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(condscores<span class="sc">$</span>Land_use.wec) <span class="ot">&lt;-</span> <span class="fu">contr.wec</span>(condscores<span class="sc">$</span>Land_use, <span class="st">"Commercial forestry"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>condscores<span class="sc">$</span>Fossitt.wec <span class="ot">&lt;-</span> <span class="fu">factor</span>(condscores<span class="sc">$</span>Fossitt)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(condscores<span class="sc">$</span>Fossitt.wec) <span class="ot">&lt;-</span> <span class="fu">contr.wec</span>(condscores<span class="sc">$</span>Fossitt, <span class="st">"WD4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="m7---model-7" class="level5">
<h5 class="anchored" data-anchor-id="m7---model-7">m7 - model 7</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>m7 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(condscore <span class="sc">~</span> Land_use.wec <span class="sc">+</span> Fossitt.wec <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Site), <span class="at">data =</span> condscores)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: condscore ~ Land_use.wec + Fossitt.wec + (1 | Site)
   Data: condscores

REML criterion at convergence: -938.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2257 -0.6284  0.0000  0.6607  4.6138 

Random effects:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.005700 0.07550 
 Residual             0.009887 0.09943 
Number of obs: 593, groups:  Site, 7

Fixed effects:
                                         Estimate Std. Error t value
(Intercept)                               0.46123    0.03179  14.509
Land_use.wecAgriculture                  -0.01239    0.03463  -0.358
Land_use.wecUpland blanket bog and heath -0.04159    0.08381  -0.496
Fossitt.wecBC1                            0.13788    0.05849   2.357
Fossitt.wecED3                           -0.11960    0.01644  -7.276
Fossitt.wecED3HH1                         0.02253    0.03277   0.688
Fossitt.wecFL1                            0.15531    0.03162   4.912
Fossitt.wecFL2                           -0.21136    0.10031  -2.107
Fossitt.wecFS1                            0.33617    0.10037   3.349
Fossitt.wecFW2                           -0.15593    0.07183  -2.171
Fossitt.wecGA1                           -0.06288    0.01431  -4.393
Fossitt.wecGS1                           -0.08394    0.03722  -2.255
Fossitt.wecGS2                           -0.13828    0.01572  -8.796
Fossitt.wecGS3                           -0.09135    0.10099  -0.905
Fossitt.wecGS4                           -0.04385    0.03542  -1.238
Fossitt.wecHD1                           -0.16460    0.05022  -3.278
Fossitt.wecHH1                           -0.02881    0.10031  -0.287
Fossitt.wecHH3                            0.04199    0.07249   0.579
Fossitt.wecLR4                           -0.05272    0.10037  -0.525
Fossitt.wecPB2                            0.07617    0.02827   2.695
Fossitt.wecPB4                            0.22197    0.03060   7.254
Fossitt.wecPB4HH3                         0.20938    0.01690  12.387
Fossitt.wecPB5                           -0.05298    0.04995  -1.061
Fossitt.wecWS1                           -0.18532    0.02679  -6.917
Fossitt.wecWS5                            0.08372    0.03094   2.706</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 25 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting m7</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>m7_fixed_effects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m7)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>m7_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m7)))</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>m7_plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Effect =</span> <span class="fu">names</span>(m7_fixed_effects),</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Estimate =</span> m7_fixed_effects,</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">SE =</span> m7_se)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the (Intercept) row, as it's not needed for the plot</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>m7_plot_data<span class="ot">&lt;-</span> m7_plot_data[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>m7_plot_data<span class="sc">$</span>LowerCI <span class="ot">&lt;-</span> m7_plot_data<span class="sc">$</span>Estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> m7_plot_data<span class="sc">$</span>SE</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>m7_plot_data<span class="sc">$</span>UpperCI <span class="ot">&lt;-</span> m7_plot_data<span class="sc">$</span>Estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> m7_plot_data<span class="sc">$</span>SE</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m7_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> Effect)) <span class="sc">+</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> LowerCI, <span class="at">xmax =</span> UpperCI), <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Estimate"</span>, <span class="at">y =</span> <span class="st">"Effect"</span>) <span class="sc">+</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#testing parameters using the DHARMa package</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co">#m7</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>m7_simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> m7, <span class="at">n =</span> <span class="dv">250</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m7_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(m7_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.91358, p-value = 0.776
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testZeroInflation</span>(m7_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa zero-inflation test via comparison to expected zeros with
    simulation under H0 = fitted model

data:  simulationOutput
ratioObsSim = NaN, p-value = 1
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(m7_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.372 0.676 0.888 0.688 0.672 0.756 0.756 0.408 0.588 0.508 0.388 0.408
 [13] 0.896 0.640 0.700 0.488 0.444 0.460 0.580 0.256 0.284 0.312 0.412 0.572
 [25] 0.816 0.176 0.596 0.180 0.736 0.704 0.836 0.492 0.420 0.468 0.616 0.768
 [37] 0.524 0.572 0.756 0.772 0.540 0.512 0.696 0.516 0.796 0.748 0.516 0.784
 [49] 0.704 0.544 0.540 0.536 0.612 0.536 0.516 0.616 0.556 0.560 0.516 0.552
 [61] 0.768 0.692 0.668 0.432 0.716 0.800 0.720 0.548 0.804 0.776 0.800 0.776
 [73] 0.824 0.612 0.696 0.652 0.812 0.076 0.556 0.812 0.968 1.000 0.856 0.872
 [85] 0.988 0.700 0.844 0.832 0.792 0.772 0.508 0.764 0.512 0.724 1.000 0.920
 [97] 0.740 0.876 0.704 0.760 0.692 0.244 0.892 0.996 0.960 0.744 0.792 0.980
[109] 0.500 0.232 0.264 0.252 0.508 0.232 0.216 0.740 0.748 0.712 0.984 0.916
[121] 0.996 0.980 0.904 0.996 0.512 0.752 0.548 0.768 0.736 0.904 0.248 0.528
[133] 0.708 0.888 0.748 0.516 0.980 0.904 0.904 0.868 0.700 0.916 0.928 0.788
[145] 0.708 0.928 0.884 0.924 0.880 0.968 0.960 0.508 0.560 0.740 0.516 0.548
[157] 0.972 0.972 0.888 0.936 0.736 0.732 0.912 0.744 1.000 0.908 1.000 0.904
[169] 0.880 0.588 0.664 0.784 0.552 0.700 0.768 0.892 0.964 0.916 0.864 0.880
[181] 0.712 0.884 0.880 0.992 0.944 0.944 0.160 0.360 0.696 0.920 0.556 0.480
[193] 0.832 0.360 0.964 0.376 0.608 0.940 0.868 0.756 0.636 0.992 0.920 0.900
[205] 0.392 0.368 0.856 0.664 0.648 0.132 0.116 0.176 0.192 0.080 0.408 0.788
[217] 0.576 0.764 0.392 0.420 0.804 0.996 0.564 0.344 0.588 0.356 0.972 0.728
[229] 0.692 0.404 0.608 0.620 0.412 0.100 0.772 0.036 0.420 0.636 0.392 0.432
[241] 0.240 0.604 0.436 0.692 0.640 0.820 0.268 0.228 0.676 0.036 0.020 0.084
[253] 0.048 0.244 0.128 0.148 0.480 0.036 0.024 0.644 0.300 0.252 0.416 0.396
[265] 0.436 0.248 0.260 0.408 0.632 0.812 0.648 0.488 0.804 0.836 0.960 0.672
[277] 0.812 0.904 0.804 0.440 0.660 0.836 0.916 0.656 0.428 0.276 0.644 0.440
[289] 0.436 0.432 0.664 0.444 0.456 0.656 0.612 0.056 0.080 0.124 0.000 0.132
[301] 0.108 0.012 0.028 0.236 0.404 0.460 0.448 0.648 0.432 0.616 0.620 0.676
[313] 0.260 0.152 0.036 0.112 0.284 0.964 0.672 0.952 0.836 0.828 0.592 0.820
[325] 0.620 0.284 0.428 0.472 0.104 0.140 0.064 0.128 0.476 0.436 0.120 0.416
[337] 0.424 0.788 0.412 0.464 0.416 0.188 0.792 0.180 0.516 0.524 0.240 0.292
[349] 0.108 0.416 0.180 0.508 0.220 0.444 0.476 0.460 0.188 0.352 0.236 0.080
[361] 0.552 0.172 0.224 0.176 0.280 0.284 0.312 0.320 0.200 0.452 0.448 0.468
[373] 0.212 0.400 0.444 0.220 0.424 0.188 0.468 0.280 0.428 0.228 0.160 0.424
[385] 0.056 0.588 0.440 0.168 0.056 0.176 0.232 0.380 0.404 0.428 0.424 0.636
[397] 0.796 0.672 0.276 0.692 0.452 0.388 0.712 0.908 0.560 0.508 0.332 0.496
[409] 0.280 0.252 0.488 0.264 0.516 0.960 0.888 0.900 0.968 0.640 0.640 0.512
[421] 0.308 0.180 0.060 0.060 0.332 0.296 0.268 0.588 0.220 0.148 0.328 0.672
[433] 0.692 0.360 0.784 0.696 0.404 0.556 0.648 0.288 0.484 0.124 0.780 0.640
[445] 0.352 0.580 0.524 0.416 0.360 0.220 0.020 0.760 0.568 0.376 0.652 0.620
[457] 0.164 0.484 0.228 0.580 0.408 0.600 0.632 0.372 0.296 0.500 0.580 0.328
[469] 0.308 0.308 0.196 0.288 0.304 0.224 0.580 0.248 0.148 0.516 0.112 0.136
[481] 0.132 0.072 0.112 0.100 0.124 0.096 0.164 0.128 0.116 0.076 0.112 0.132
[493] 0.136 0.116 0.100 0.124 0.084 0.128 0.116 0.224 0.236 0.076 0.116 0.140
[505] 0.076 0.080 0.104 0.116 0.096 0.456 0.672 0.468 0.096 0.472 0.408 0.560
[517] 0.496 0.196 0.196 0.172 0.464 0.584 0.528 0.456 0.172 0.820 0.448 0.192
[529] 0.180 1.000 0.324 0.480 0.616 0.788 0.284 0.484 0.636 0.492 0.244 0.572
[541] 0.776 0.448 0.856 0.088 0.928 0.964 0.432 0.380 0.324 0.632 0.416 0.388
[553] 0.244 0.420 0.260 0.444 0.336 0.896 0.316 0.984 0.872 0.720 0.880 0.900
[565] 0.952 0.556 0.440 0.136 0.632 0.556 0.556 0.732 0.112 0.484 0.248 0.536
[577] 0.340 0.548 0.284 0.500 0.324 0.180 0.568 0.056 0.536 0.284 0.984 0.472
[589] 0.576 0.968 0.716 0.452 0.692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(m7_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testResiduals</span>(m7_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-31-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$uniformity

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.071791, p-value = 0.00443
alternative hypothesis: two-sided


$dispersion

    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.91358, p-value = 0.776
alternative hypothesis: two.sided


$outliers

    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  simulationOutput
outliers at both margin(s) = 6, observations = 593, p-value = 0.4845
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.003721941 0.021891854
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                            0.01011804 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$uniformity

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.071791, p-value = 0.00443
alternative hypothesis: two-sided


$dispersion

    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.91358, p-value = 0.776
alternative hypothesis: two.sided


$outliers

    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  simulationOutput
outliers at both margin(s) = 6, observations = 593, p-value = 0.4845
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.003721941 0.021891854
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                            0.01011804 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testUniformity</span>(m7_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-31-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.071791, p-value = 0.00443
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract fixed effects coefficients</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>m7_fixedeffects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m7)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co">#identify the reference levels</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>m7_referencelevels <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Land_use.wec =</span> <span class="st">"Commercial forestry"</span>,</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fossitt.wec =</span> <span class="st">"WD4"</span>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">#create a data frame with the combinations of predictor levels </span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>m7_predictedresponse <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Land_use.wec =</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Commercial forestry"</span>, <span class="st">"Upland blanket bog and heath"</span>),</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fossitt.wec =</span> <span class="fu">c</span>(<span class="st">"BC1"</span>,    <span class="st">"ED3"</span>,    <span class="st">"ED3HH1"</span>, <span class="st">"FL1"</span>,    <span class="st">"FL2"</span>,    <span class="st">"FS1"</span>,    <span class="st">"FW2"</span>,    <span class="st">"GA1"</span>,    <span class="st">"GS1"</span>,    <span class="st">"GS2"</span>,   </span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"GS3"</span>,    <span class="st">"GS4"</span>,    <span class="st">"HD1"</span>,    <span class="st">"HH1"</span>,   <span class="st">"HH3"</span>,  <span class="st">"LR4"</span>,    <span class="st">"PB2"</span>,    <span class="st">"PB4"</span>,    <span class="st">"PB4HH3"</span>, <span class="st">"PB5"</span>,   </span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"WD4"</span>,    <span class="st">"WS1"</span>,    <span class="st">"WS5"</span>))</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="co">#use relevel to set reference levels</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (variable <span class="cf">in</span> <span class="fu">names</span>(m7_referencelevels)) {</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>  m7_predictedresponse[[variable]] <span class="ot">&lt;-</span> <span class="fu">relevel</span>(m7_predictedresponse[[variable]], m7_referencelevels[[variable]])</span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>m7_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(m7, <span class="at">newdata =</span> m7_predictedresponse, <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>m7_predictedresponse<span class="sc">$</span>predicted <span class="ot">&lt;-</span> m7_predicted</span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m7_predictedresponse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Land_use.wec Fossitt.wec predicted
1                   Agriculture         BC1 0.5867180
2           Commercial forestry         BC1 0.6153756
3  Upland blanket bog and heath         BC1 0.5575229
4                   Agriculture         ED3 0.3292414
5           Commercial forestry         ED3 0.3578991
6  Upland blanket bog and heath         ED3 0.3000464
7                   Agriculture      ED3HH1 0.4713700
8           Commercial forestry      ED3HH1 0.5000277
9  Upland blanket bog and heath      ED3HH1 0.4421749
10                  Agriculture         FL1 0.6041429
11          Commercial forestry         FL1 0.6328006
12 Upland blanket bog and heath         FL1 0.5749478
13                  Agriculture         FL2 0.2374762
14          Commercial forestry         FL2 0.2661339
15 Upland blanket bog and heath         FL2 0.2082812
16                  Agriculture         FS1 0.7850098
17          Commercial forestry         FS1 0.8136675
18 Upland blanket bog and heath         FS1 0.7558147
19                  Agriculture         FW2 0.2929120
20          Commercial forestry         FW2 0.3215697
21 Upland blanket bog and heath         FW2 0.2637170
22                  Agriculture         GA1 0.3859574
23          Commercial forestry         GA1 0.4146151
24 Upland blanket bog and heath         GA1 0.3567623
25                  Agriculture         GS1 0.3648932
26          Commercial forestry         GS1 0.3935509
27 Upland blanket bog and heath         GS1 0.3356981
28                  Agriculture         GS2 0.3105548
29          Commercial forestry         GS2 0.3392125
30 Upland blanket bog and heath         GS2 0.2813597
31                  Agriculture         GS3 0.3574921
32          Commercial forestry         GS3 0.3861498
33 Upland blanket bog and heath         GS3 0.3282970
34                  Agriculture         GS4 0.4049849
35          Commercial forestry         GS4 0.4336426
36 Upland blanket bog and heath         GS4 0.3757898
37                  Agriculture         HD1 0.2842375
38          Commercial forestry         HD1 0.3128952
39 Upland blanket bog and heath         HD1 0.2550425
40                  Agriculture         HH1 0.4200232
41          Commercial forestry         HH1 0.4486809
42 Upland blanket bog and heath         HH1 0.3908281
43                  Agriculture         HH3 0.4908254
44          Commercial forestry         HH3 0.5194831
45 Upland blanket bog and heath         HH3 0.4616304
46                  Agriculture         LR4 0.3961209
47          Commercial forestry         LR4 0.4247786
48 Upland blanket bog and heath         LR4 0.3669259
49                  Agriculture         PB2 0.5250110
50          Commercial forestry         PB2 0.5536687
51 Upland blanket bog and heath         PB2 0.4958159
52                  Agriculture         PB4 0.6708096
53          Commercial forestry         PB4 0.6994673
54 Upland blanket bog and heath         PB4 0.6416145
55                  Agriculture      PB4HH3 0.6582170
56          Commercial forestry      PB4HH3 0.6868747
57 Upland blanket bog and heath      PB4HH3 0.6290219
58                  Agriculture         PB5 0.3958617
59          Commercial forestry         PB5 0.4245194
60 Upland blanket bog and heath         PB5 0.3666667
61                  Agriculture         WD4 0.4555999
62          Commercial forestry         WD4 0.4842576
63 Upland blanket bog and heath         WD4 0.4264049
64                  Agriculture         WS1 0.2635130
65          Commercial forestry         WS1 0.2921707
66 Upland blanket bog and heath         WS1 0.2343180
67                  Agriculture         WS5 0.5325612
68          Commercial forestry         WS5 0.5612189
69 Upland blanket bog and heath         WS5 0.5033662</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot on a forest plot:</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create labels</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>land_use_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Commercial Forestry"</span>, <span class="st">"Upland blanket bog and heath"</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>Fossitt_habitat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BC1"</span>,    <span class="st">"ED3"</span>,    <span class="st">"ED3HH1"</span>, <span class="st">"FL1"</span>,    <span class="st">"FL2"</span>,    <span class="st">"FS1"</span>,    <span class="st">"FW2"</span>,    <span class="st">"GA1"</span>,    <span class="st">"GS1"</span>,    <span class="st">"GS2"</span>,   </span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"GS3"</span>,    <span class="st">"GS4"</span>,    <span class="st">"HD1"</span>,    <span class="st">"HH1"</span>,   <span class="st">"HH3"</span>,  <span class="st">"LR4"</span>,    <span class="st">"PB2"</span>,    <span class="st">"PB4"</span>,    <span class="st">"PB4HH3"</span>, <span class="st">"PB5"</span>,   </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"WD4"</span>,    <span class="st">"WS1"</span>,    <span class="st">"WS5"</span>)</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="co">#create a new column for the combined factor levels</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>m7_predictedresponse<span class="sc">$</span>combined_levels <span class="ot">&lt;-</span> <span class="fu">interaction</span>(m7_predictedresponse<span class="sc">$</span>Land_use.wec, m7_predictedresponse<span class="sc">$</span>Fossitt.wec)</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co">#define the order of the levels</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>m7_predictedresponse<span class="sc">$</span>combined_levels <span class="ot">&lt;-</span> <span class="fu">factor</span>(m7_predictedresponse<span class="sc">$</span>combined_levels, <span class="at">levels =</span> <span class="fu">interaction</span>(land_use_levels, Fossitt_habitat_levels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ans * length(l) + if1: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m7_predictedresponse, <span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> Fossitt.wec, <span class="at">color =</span> Land_use.wec)) <span class="sc">+</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> predicted <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>, <span class="at">xmax =</span> predicted <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>), <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted response"</span>, <span class="at">y =</span> <span class="st">"Land use"</span>) <span class="sc">+</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m7_predictedresponse, <span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> Land_use.wec, <span class="at">color =</span> Fossitt.wec)) <span class="sc">+</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> predicted <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>, <span class="at">xmax =</span> predicted <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>), <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted response"</span>, <span class="at">y =</span> <span class="st">"Land use"</span>) <span class="sc">+</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="m8---model-8" class="level5">
<h5 class="anchored" data-anchor-id="m8---model-8">m8 - model 8</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>m8 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(condscore <span class="sc">~</span> IUCN_habitat.wec <span class="sc">+</span> Land_use.wec <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Site), <span class="at">data =</span> condscores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#testing parameters using the DHARMa package</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co">#m8</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>m8_simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> m8, <span class="at">n=</span> <span class="dv">250</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m8_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(m8_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.90412, p-value = 0.816
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testZeroInflation</span>(m8_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa zero-inflation test via comparison to expected zeros with
    simulation under H0 = fitted model

data:  simulationOutput
ratioObsSim = NaN, p-value = 1
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(m8_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.280 0.480 0.720 0.492 0.452 0.880 0.884 0.652 0.764 0.740 0.644 0.628
 [13] 0.956 0.852 0.832 0.720 0.284 0.348 0.396 0.144 0.156 0.184 0.300 0.444
 [25] 0.656 0.104 0.412 0.092 0.584 0.588 0.668 0.328 0.228 0.340 0.864 0.776
 [37] 0.548 0.512 0.760 0.824 0.524 0.560 0.680 0.520 0.808 0.700 0.556 0.788
 [49] 0.712 0.568 0.556 0.500 0.616 0.560 0.496 0.552 0.552 0.500 0.512 0.612
 [61] 0.764 0.708 0.672 0.472 0.684 0.784 0.704 0.524 0.712 0.764 0.768 0.756
 [73] 0.768 0.620 0.748 0.600 0.860 0.204 0.772 0.744 0.944 0.988 0.812 0.812
 [85] 0.980 0.572 0.752 0.756 0.660 0.692 0.436 0.708 0.476 0.724 1.000 0.892
 [97] 0.740 0.872 0.712 0.744 0.680 0.284 0.892 0.992 0.964 0.700 0.708 0.976
[109] 0.500 0.220 0.260 0.252 0.448 0.240 0.216 0.708 0.696 0.720 0.968 0.860
[121] 0.992 0.976 0.904 0.996 0.460 0.704 0.520 0.740 0.788 0.908 0.196 0.412
[133] 0.628 0.896 0.680 0.476 0.964 0.864 0.900 0.888 0.652 0.888 0.884 0.708
[145] 0.748 0.888 0.872 0.916 0.880 0.944 0.988 0.444 0.468 0.728 0.396 0.444
[157] 0.968 0.964 0.868 0.860 0.720 0.692 0.860 0.720 1.000 0.884 1.000 0.952
[169] 0.912 0.496 0.620 0.740 0.544 0.676 0.664 0.856 0.888 0.892 0.856 0.868
[181] 0.644 0.860 0.896 0.968 0.916 0.988 0.348 0.564 0.872 0.888 0.456 0.468
[193] 0.788 0.252 0.920 0.264 0.520 0.912 0.736 0.664 0.488 0.948 0.908 0.796
[205] 0.316 0.292 0.744 0.660 0.660 0.228 0.268 0.280 0.324 0.152 0.476 0.864
[217] 0.676 0.828 0.460 0.004 0.704 0.936 0.220 0.080 0.232 0.140 0.788 0.352
[229] 0.408 0.508 0.692 0.680 0.476 0.144 0.808 0.036 0.468 0.628 0.500 0.448
[241] 0.332 0.664 0.504 0.676 0.692 0.820 0.304 0.308 0.632 0.068 0.016 0.160
[253] 0.040 0.316 0.124 0.160 0.496 0.052 0.060 0.720 0.284 0.300 0.512 0.524
[265] 0.492 0.284 0.288 0.528 0.684 0.832 0.684 0.464 0.800 0.828 0.932 0.704
[277] 0.876 0.920 0.860 0.524 0.668 0.788 0.924 0.712 0.460 0.268 0.680 0.508
[289] 0.488 0.508 0.704 0.488 0.436 0.668 0.684 0.072 0.140 0.176 0.008 0.124
[301] 0.148 0.064 0.068 0.292 0.536 0.436 0.504 0.648 0.476 0.668 0.692 0.672
[313] 0.260 0.132 0.068 0.156 0.268 0.892 0.648 0.916 0.828 0.764 0.700 0.832
[325] 0.672 0.280 0.444 0.516 0.144 0.132 0.064 0.160 0.504 0.472 0.132 0.396
[337] 0.404 0.692 0.424 0.408 0.380 0.164 0.712 0.156 0.484 0.516 0.240 0.196
[349] 0.120 0.396 0.176 0.500 0.168 0.376 0.404 0.396 0.180 0.248 0.224 0.104
[361] 0.500 0.196 0.184 0.204 0.316 0.252 0.252 0.244 0.168 0.376 0.392 0.416
[373] 0.176 0.368 0.380 0.184 0.408 0.188 0.392 0.280 0.412 0.216 0.164 0.424
[385] 0.028 0.544 0.396 0.188 0.068 0.204 0.216 0.400 0.400 0.432 0.396 0.660
[397] 0.676 0.616 0.284 0.688 0.396 0.408 0.708 0.960 0.700 0.708 0.600 0.676
[409] 0.472 0.500 0.692 0.500 0.688 0.988 0.948 0.964 1.000 0.756 0.744 0.616
[421] 0.400 0.196 0.056 0.072 0.380 0.360 0.320 0.648 0.260 0.196 0.380 0.788
[433] 0.768 0.344 0.832 0.372 0.156 0.200 0.284 0.096 0.160 0.140 0.652 0.484
[445] 0.348 0.548 0.568 0.448 0.384 0.288 0.064 0.784 0.616 0.444 0.676 0.696
[457] 0.152 0.496 0.264 0.612 0.404 0.652 0.680 0.404 0.372 0.564 0.632 0.400
[469] 0.392 0.280 0.208 0.300 0.428 0.248 0.564 0.292 0.200 0.576 0.088 0.040
[481] 0.060 0.068 0.064 0.048 0.068 0.056 0.040 0.076 0.052 0.060 0.036 0.048
[493] 0.040 0.044 0.052 0.064 0.048 0.072 0.044 0.204 0.184 0.076 0.072 0.120
[505] 0.104 0.092 0.112 0.080 0.100 0.432 0.588 0.460 0.064 0.356 0.352 0.580
[517] 0.580 0.124 0.168 0.092 0.372 0.492 0.468 0.336 0.140 0.728 0.372 0.104
[529] 0.116 1.000 0.372 0.564 0.668 0.836 0.388 0.300 0.476 0.424 0.160 0.380
[541] 0.728 0.460 0.840 0.116 0.864 0.960 0.436 0.348 0.268 0.596 0.396 0.300
[553] 0.252 0.384 0.256 0.392 0.376 0.852 0.272 0.968 0.864 0.740 0.784 0.884
[565] 0.984 0.516 0.364 0.132 0.580 0.596 0.568 0.652 0.140 0.432 0.204 0.492
[577] 0.296 0.468 0.424 0.620 0.396 0.176 0.612 0.152 0.804 0.492 0.996 0.940
[589] 0.944 0.952 0.660 0.392 0.644</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(m8_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>qu = 0.75, log(sigma) = -2.737854 : outer Newton did not converge fully.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-34-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testResiduals</span>(m8_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-34-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$uniformity

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.053282, p-value = 0.06899
alternative hypothesis: two-sided


$dispersion

    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.90412, p-value = 0.816
alternative hypothesis: two.sided


$outliers

    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  simulationOutput
outliers at both margin(s) = 5, observations = 593, p-value = 0.8152
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.002743256 0.019566353
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                           0.008431703 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$uniformity

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.053282, p-value = 0.06899
alternative hypothesis: two-sided


$dispersion

    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.90412, p-value = 0.816
alternative hypothesis: two.sided


$outliers

    DHARMa outlier test based on exact binomial test with approximate
    expectations

data:  simulationOutput
outliers at both margin(s) = 5, observations = 593, p-value = 0.8152
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.002743256 0.019566353
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                           0.008431703 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testUniformity</span>(m8_simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-34-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.053282, p-value = 0.06899
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate estimated marginal means for land.use.wec</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m8, <span class="at">type =</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in anova.merMod(m8, type = "III"): additional arguments ignored: 'type'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table
                 npar  Sum Sq  Mean Sq F value
IUCN_habitat.wec   10 2.63611 0.263611 23.9411
Land_use.wec        2 0.04319 0.021595  1.9612</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>kruskal_test_result <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(condscore <span class="sc">~</span> Land_use.wec, <span class="at">data =</span> condscores)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-value</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>p_value_kruskal <span class="ot">&lt;-</span> kruskal_test_result<span class="sc">$</span>p.value</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-value</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_value_kruskal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.929556e-30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>kruskal_test_result_iucn <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(condscore <span class="sc">~</span> IUCN_habitat.wec, <span class="at">data =</span> condscores)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-value</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>p_value_kruskal_iucn <span class="ot">&lt;-</span> kruskal_test_result_iucn<span class="sc">$</span>p.value</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-value</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_value_kruskal_iucn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.65761e-39</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>kruskal_test_result_fossitt <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(condscore <span class="sc">~</span> Fossitt.wec, <span class="at">data =</span> condscores)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-value</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>p_value_kruskal_fossitt <span class="ot">&lt;-</span> kruskal_test_result_fossitt<span class="sc">$</span>p.value</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-value</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_value_kruskal_fossitt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.855606e-47</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract fixed effects coefficients</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>m8_fixedeffects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m8)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="co">#identify the reference levels</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>m8_referencelevels <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Land_use.wec =</span> <span class="st">"Commercial forestry"</span>,</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">IUCN_habitat.wec =</span> <span class="st">"Urban and industrial ecosystems"</span>)</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="co">#create a data frame with the combinations of predictor levels </span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>m8_predictedresponse <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Land_use.wec =</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Commercial forestry"</span>, <span class="st">"Upland blanket bog and heath"</span>),</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">IUCN_habitat.wec =</span> <span class="fu">c</span>(<span class="st">"Annual croplands"</span>,<span class="st">"Boreal, temperate and montane peat bogs"</span>, <span class="st">"Cool temperate heathlands"</span>, <span class="st">"Derived semi-natural pastures and oldfields"</span>, <span class="st">"Permanent lowland rivers"</span>,<span class="st">"Permanent marshes"</span>, <span class="st">"Plantations"</span>,<span class="st">"Sandy shorelines"</span>, <span class="st">"Small permanent freshwater lakes"</span>,<span class="st">"Sown pastures and fields"</span>,<span class="st">"Urban and industrial ecosystems"</span>))</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a><span class="co">#use relevel to set reference levels</span></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (variable <span class="cf">in</span> <span class="fu">names</span>(m8_referencelevels)) {</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a> m8_predictedresponse[[variable]] <span class="ot">&lt;-</span> <span class="fu">relevel</span>(m8_predictedresponse[[variable]], m8_referencelevels[[variable]])</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>m8_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(m8, <span class="at">newdata =</span> m8_predictedresponse, <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>m8_predictedresponse<span class="sc">$</span>predicted <span class="ot">&lt;-</span> m8_predicted</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m8_predictedresponse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Land_use.wec                            IUCN_habitat.wec
1                   Agriculture                            Annual croplands
2           Commercial forestry                            Annual croplands
3  Upland blanket bog and heath                            Annual croplands
4                   Agriculture     Boreal, temperate and montane peat bogs
5           Commercial forestry     Boreal, temperate and montane peat bogs
6  Upland blanket bog and heath     Boreal, temperate and montane peat bogs
7                   Agriculture                   Cool temperate heathlands
8           Commercial forestry                   Cool temperate heathlands
9  Upland blanket bog and heath                   Cool temperate heathlands
10                  Agriculture Derived semi-natural pastures and oldfields
11          Commercial forestry Derived semi-natural pastures and oldfields
12 Upland blanket bog and heath Derived semi-natural pastures and oldfields
13                  Agriculture                    Permanent lowland rivers
14          Commercial forestry                    Permanent lowland rivers
15 Upland blanket bog and heath                    Permanent lowland rivers
16                  Agriculture                           Permanent marshes
17          Commercial forestry                           Permanent marshes
18 Upland blanket bog and heath                           Permanent marshes
19                  Agriculture                                 Plantations
20          Commercial forestry                                 Plantations
21 Upland blanket bog and heath                                 Plantations
22                  Agriculture                            Sandy shorelines
23          Commercial forestry                            Sandy shorelines
24 Upland blanket bog and heath                            Sandy shorelines
25                  Agriculture            Small permanent freshwater lakes
26          Commercial forestry            Small permanent freshwater lakes
27 Upland blanket bog and heath            Small permanent freshwater lakes
28                  Agriculture                    Sown pastures and fields
29          Commercial forestry                    Sown pastures and fields
30 Upland blanket bog and heath                    Sown pastures and fields
31                  Agriculture             Urban and industrial ecosystems
32          Commercial forestry             Urban and industrial ecosystems
33 Upland blanket bog and heath             Urban and industrial ecosystems
   predicted
1  0.5903599
2  0.6583634
3  0.4676954
4  0.6007389
5  0.6687425
6  0.4780744
7  0.2866273
8  0.3546308
9  0.1639627
10 0.3227390
11 0.3907425
12 0.2000745
13 0.2997238
14 0.3677273
15 0.1770593
16 0.7870668
17 0.8550703
18 0.6644023
19 0.4232716
20 0.4912751
21 0.3006071
22 0.3981779
23 0.4661815
24 0.2755134
25 0.5300501
26 0.5980536
27 0.4073855
28 0.3853538
29 0.4533573
30 0.2626893
31 0.3586139
32 0.4266174
33 0.2359493</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot on a forest plot:</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create a new column for the combined factor levels</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>land_use_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Agriculture"</span>, <span class="st">"Commercial Forestry"</span>, <span class="st">"Upland blanket bog and heath"</span>)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>IUCN_habitat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Annual croplands"</span>,<span class="st">"Boreal, temperate and montane peat bogs"</span>, <span class="st">"Cool temperate heathlands"</span>, <span class="st">"Derived semi-natural pastures and oldfields"</span>, <span class="st">"Permanent lowland rivers"</span>,<span class="st">"Permanent marshes"</span>, <span class="st">"Plantations"</span>,<span class="st">"Sandy shorelines"</span>, <span class="st">"Small permanent freshwater lakes"</span>,<span class="st">"Sown pastures and fields"</span>,<span class="st">"Urban and industrial ecosystems"</span>)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="co">#create a new column for the combined factor levels</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>m8_predictedresponse<span class="sc">$</span>combined_levels <span class="ot">&lt;-</span> <span class="fu">interaction</span>(m8_predictedresponse<span class="sc">$</span>Land_use.wec, m8_predictedresponse<span class="sc">$</span>IUCN_habitat.wec)</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="co">#define the order of the levels</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>m8_predictedresponse<span class="sc">$</span>combined_levels <span class="ot">&lt;-</span> <span class="fu">factor</span>(m8_predictedresponse<span class="sc">$</span>combined_levels, <span class="at">levels =</span> <span class="fu">interaction</span>(land_use_levels, IUCN_habitat_levels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ans * length(l) + if1: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the forest plot</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m8_predictedresponse, <span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> IUCN_habitat.wec, <span class="at">color =</span> Land_use.wec)) <span class="sc">+</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> predicted <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>, <span class="at">xmax =</span> predicted <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>), <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted response"</span>, <span class="at">y =</span> <span class="st">"Land use"</span>) <span class="sc">+</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m8_predictedresponse, <span class="fu">aes</span>(<span class="at">x =</span> IUCN_habitat.wec, <span class="at">y =</span> predicted, <span class="at">color =</span> Land_use.wec)) <span class="sc">+</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> predicted <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>, <span class="at">xmax =</span> predicted <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.11050</span>), <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted response"</span>, <span class="at">y =</span> <span class="st">"Land use"</span>) <span class="sc">+</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Kingetal_AccountingforBiodiversity_Code_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="m9---model-9" class="level5">
<h5 class="anchored" data-anchor-id="m9---model-9">m9 - model 9</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>m9 <span class="ot">&lt;-</span> <span class="fu">glm</span>(condscore <span class="sc">~</span> Land_use, <span class="at">data =</span> condscores)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = condscore ~ Land_use, data = condscores)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.30067  -0.10067  -0.00901   0.08822   0.42155  

Coefficients: (2 not defined because of singularities)
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.467340   0.006388   73.15   &lt;2e-16 ***
Land_use1         NA         NA      NA       NA    
Land_use2         NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.02420201)

    Null deviance: 14.328  on 592  degrees of freedom
Residual deviance: 14.328  on 592  degrees of freedom
AIC: -520.88

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>